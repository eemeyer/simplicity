<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" xml:lang="en-us">
  <head>
    <title>Tutorial Search</title>
    <link href="../css/lib/yui-grids-min-3.2.0.css" rel="stylesheet" type="text/css" />
    <link href="../css/lib/jquery-ui-1.8.7.custom.css" rel="stylesheet" type="text/css" />
    <link href="../css/simplicity/simplicityPagination.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="../images/favicon.jpg"/>
    <style>
      body {
        margin: auto; /* center in viewport */
        width: 960px;
        font-size:62.5%;
      }
      #nav {
        width: 200px;
      }
      #main {
        width: 760px;
      }
      #themeSwitcher {
        float: right;
      }
      #themeSwitcherButton {
        float: right;
      }
      .result-set .result-row {
        margin-top: 6px;
        margin-bottom: 6px;
      }
      .ui-simplicity-facet-count {
        float: right;
      }
      #styleCheckboxes ul {
        list-style-type: none;
        padding-left: 1em;
      }
      .child {
        margin-left: 1em;
      }
      #neighborhoodCheckboxes, #neighborhoodCheckboxes2 {
        height: 18em;
        overflow: scroll;
      }
    </style>
  </head>
  <body>
    <div id="themeSwitcher" class="ui-helper-clearfix">
      <button id="themeSwitcherButton">Theme</button>
    </div>
    <h1><a href="index.html">home</a> | Tutorial Search with Yahoo</h1>
    <form id="myForm" onsubmit="return false;">
      <div class="yui3-g">
        <div id="nav" class="yui3-u">
          <fieldset>
            <legend>Search Controls</legend>
            <button id="searchButton">Search</button>
            <br />
            <button id="resetButton">Reset</button>
            <br />
            <label for="pageSize">Page Size</label>
            <select id="pageSize" name="pageSize">
              <option value=""></option>
              <option value="5">5</option>
              <option value="10">10</option>
              <option value="15">15</option>
              <option value="20">20</option>
              <option value="50">50</option>
            </select>
          </fieldset>
          <fieldset>
            <legend>Type</legend>
            <select name="type">
              <option value="">Select...</option>
              <option value="rentals">Rentals</option>
              <option value="sales">Sales</option>
            </select>
          </fieldset>
          <fieldset id="conditionCheckboxes">
            <legend>Condition</legend>
            <div class="row">
              <input type="checkbox" id="condition_0" name="condition" value="0" />
              <label for="condition_0">Money pit</label>
            </div>
            <div class="row">
              <input type="checkbox" id="condition_1" name="condition" value="1" />
              <label for="condition_1">Fixer-upper</label>
            </div>
            <div class="row">
              <input type="checkbox" id="condition_2" name="condition" value="2" />
              <label for="condition_2">Needs work</label>
            </div>
            <div class="row">
              <input type="checkbox" id="condition_3" name="condition" value="3" />
              <label for="condition_3">Good shape</label>
            </div>
            <div class="row">
              <input type="checkbox" id="condition_4" name="condition" value="4" />
              <label for="condition_4">Excellent condition</label>
            </div>
          </fieldset>
          <fieldset id="locationFields2">
            <legend>Location</legend>
            <input id="address2" name="a" />
            <br />
            <label for="north">North</label>
            <input id="north" name="n" />
            <br />
            <label for="east">East</label>
            <input id="east" name="e" />
            <br />
            <label for="south">South</label>
            <input id="south" name="s" />
            <br />
            <label for="west">West</label>
            <input id="west" name="w" />
          </fieldset>
          <fieldset id="neighborhoodCheckboxes">
            <legend>Neighborhood</legend>
            <div class="row">
              <input type="checkbox" id="neighborhood_north" name="locationTree" value="north" />
              <label for="neighborhood_north">North</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_inwood" name="locationTree" value="inwood" />
              <label for="neighborhood_inwood">Inwood</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_east_harlem" name="locationTree" value="east_harlem" />
              <label for="neighborhood_east_harlem">East Harlem</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_harlem" name="locationTree" value="harlem" />
              <label for="neighborhood_harlem">Harlem</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_washington_heights" name="locationTree" value="washington_heights" />
              <label for="neighborhood_washington_heights">Washington Heights</label>
            </div>
            <div class="row">
              <input type="checkbox" id="neighborhood_uptown" name="locationTree" value="uptown" />
              <label for="neighborhood_uptown">Uptown</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_upper_west_side" name="locationTree" value="upper_west_side" />
              <label for="neighborhood_upper_west_side">Upper West Side</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_upper_east_side" name="locationTree" value="upper_east_side" />
              <label for="neighborhood_upper_east_side">Upper East Side</label>
            </div>
            <div class="row">
              <input type="checkbox" id="neighborhood_midtown" name="locationTree" value="midtown" />
              <label for="neighborhood_midtown">Midtown</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_hells_kitchen" name="locationTree" value="hells_kitchen" />
              <label for="neighborhood_hells_kitchen">Hell&apos;s Kitchen</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_times_square" name="locationTree" value="times_square" />
              <label for="neighborhood_times_square">Times Square</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_murray_hill" name="locationTree" value="murray_hill" />
              <label for="neighborhood_murray_hill">Murray Hill</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_turtle_bay" name="locationTree" value="turtle_bay" />
              <label for="neighborhood_turtle_bay">Turtle Bay</label>
            </div>
            <div class="row">
              <input type="checkbox" id="neighborhood_downtown" name="locationTree" value="downtown" />
              <label for="neighborhood_downtown">Downtown</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_kips_bay" name="locationTree" value="kips_bay" />
              <label for="neighborhood_kips_bay">Kips Bay</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_chelsea" name="locationTree" value="chelsea" />
              <label for="neighborhood_chelsea">Chelsea</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_union_square" name="locationTree" value="union_square" />
              <label for="neighborhood_union_square">Union Square</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_alphabet_city" name="locationTree" value="alphabet_city" />
              <label for="neighborhood_alphabet_city">Alphabet City</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_east_village" name="locationTree" value="east_village" />
              <label for="neighborhood_east_village">East Village</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_greenwich_village_(west_village)" name="locationTree" value="greenwich_village_(west_village)" />
              <label for="neighborhood_greenwich_village_(west_village)">Greenwich Village</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_battery_park_city" name="locationTree" value="battery_park_city" />
              <label for="neighborhood_battery_park_city">Battery Park City</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_south_street_seaport" name="locationTree" value="south_street_seaport" />
              <label for="neighborhood_south_street_seaport">South Street Seaport</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_chinatown" name="locationTree" value="chinatown" />
              <label for="neighborhood_chinatown">Chinatown</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_lower_east_side" name="locationTree" value="lower_east_side" />
              <label for="neighborhood_lower_east_side">Lower East Side</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_tribeca" name="locationTree" value="tribeca" />
              <label for="neighborhood_tribeca">Tribeca</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_wall_street" name="locationTree" value="wall_street" />
              <label for="neighborhood_wall_street">Wall Street</label>
            </div>
          </fieldset>
          <fieldset id="neighborhoodCheckboxes2">
            <legend>Neighborhood Geoshapes</legend>
            <div class="row">
              <label>North</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_inwood2" name="location" value="Inwood" />
              <label for="neighborhood_inwood2">Inwood</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_east_harlem2" name="location" value="East Harlem" />
              <label for="neighborhood_east_harlem2">East Harlem</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_harlem2" name="location" value="Harlem" />
              <label for="neighborhood_harlem2">Harlem</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_washington_heights2" name="location" value="Washington Heights" />
              <label for="neighborhood_washington_heights2">Washington Heights</label>
            </div>
            <div class="row">
              <label>Uptown</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_upper_west_side2" name="location" value="Upper West Side" />
              <label for="neighborhood_upper_west_side2">Upper West Side</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_upper_east_side2" name="location" value="Upper East Side" />
              <label for="neighborhood_upper_east_side2">Upper East Side</label>
            </div>
            <div class="row">
              <label>Midtown</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_hells_kitchen2" name="location" value="Hell&apos;s Kitchen" />
              <label for="neighborhood_hells_kitchen2">Hell&apos;s Kitchen</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_times_square2" name="location" value="Times Square" />
              <label for="neighborhood_times_square2">Times Square</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_murray_hill2" name="location" value="Murray Hill" />
              <label for="neighborhood_murray_hill2">Murray Hill</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_turtle_bay2" name="location" value="Turtle Bay" />
              <label for="neighborhood_turtle_bay2">Turtle Bay</label>
            </div>
            <div class="row">
              <label>Downtown</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_kips_bay2" name="location" value="Kips Bay" />
              <label for="neighborhood_kips_bay2">Kips Bay</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_chelsea2" name="location" value="Chelsea" />
              <label for="neighborhood_chelsea2">Chelsea</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_union_square2" name="location" value="Union Square" />
              <label for="neighborhood_union_square2">Union Square</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_alphabet_city2" name="location" value="Alphabet City" />
              <label for="neighborhood_alphabet_city2">Alphabet City</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_east_village2" name="location" value="East Village" />
              <label for="neighborhood_east_village2">East Village</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_greenwich_village_(west_village)2" name="location" value="Greenwich Village (West Village)" />
              <label for="neighborhood_greenwich_village_(west_village)2">Greenwich Village</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_battery_park_city2" name="location" value="Battery Park City" />
              <label for="neighborhood_battery_park_city2">Battery Park City</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_south_street_seaport2" name="location" value="South Street Seaport" />
              <label for="neighborhood_south_street_seaport2">South Street Seaport</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_chinatown2" name="location" value="Chinatown" />
              <label for="neighborhood_chinatown2">Chinatown</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_lower_east_side2" name="location" value="Lower East Side" />
              <label for="neighborhood_lower_east_side2">Lower East Side</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_tribeca2" name="location" value="TriBeCa" />
              <label for="neighborhood_tribeca2">TriBeCa</label>
            </div>
            <div class="row child">
              <input type="checkbox" id="neighborhood_wall_street2" name="location" value="Wall Street" />
              <label for="neighborhood_wall_street2">Wall Street</label>
            </div>
          </fieldset>
        </div>
        <div id="main" class="yui3-u">
          <div class="yui3-g">
           <fieldset class="ui-widget ui-widget-content">
             <div id="map" style="width: 700px; height: 300px;"></div>
           </fieldset>
          </div>
          <fieldset class="ui-widget ui-widget-content">
            <legend>Pagination</legend>
            <div id="paginationWidget"></div>
          </fieldset>
          <fieldset class="ui-widget">
            <legend>Search Results</legend>
            <div id="searchResults"></div>
          </fieldset>
          <div id="debug" class="yui3-g"></div>
        </div>
      </div>
    </form>
    <script type="text/javascript" src="../js/lib/jquery-1.5.1.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/lib/jquery-ui-1.8.7.custom.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/lib/jquery.pagination-2.1.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/lib/jquery.bgiframe-2.1.2.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/lib/jquery.ba-bbq-1.2.1.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/lib/jquery.numberformatter-1.1.0.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/lib/jquery.ui.autocomplete.selectFirst-2010-10-25.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/lib/json2.js" charset="utf-8"></script>

    <script type="text/javascript" src="http://api.maps.yahoo.com/ajaxymap?v=3.8&appid=YD-eQRpTl0_JX2E95l_xAFs5UwZUlNQhhn7lj1H"></script>

    <script type="text/javascript" src="../js/simplicity/simplicityEquiv.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityLoadJs.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityState.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityFromState.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityToState.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityHistory.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityDiscoverySearch.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityInputs.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityDebug.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicitySlider.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityFacetCount.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityFacetedInput.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityPagination.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityPageSnapBack.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicitySearchResults.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityRenderParamsSearchResults.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityFlyout.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityYahooMap.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityYahooMapResults.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityYahooMapCriteria.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityYahooMapBoundsCoordinator.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityYahooMapBoundsTracker.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityYahooGeocoder.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityGeoJsonToYahoo.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/simplicity/simplicityGeoJsonToVendor.js" charset="utf-8"></script>
    <script type="text/javascript"><!--//<![CDATA[
      $('#nav fieldset').addClass("ui-widget ui-widget-content");

      $('#themeSwitcherButton').button().click(function (evt) {
        $('#themeSwitcherButton').remove()
        $.simplicityLoadJs('http://jqueryui.com/themeroller/themeswitchertool/', function () {
          $('#themeSwitcher').themeswitcher({
            width: 200,
            height: 600,
            closeOnSelect: false
          });
        });
      });

      $('body').simplicityState();

      $('#nav :input[name="pageSize"]').simplicityInputs();

      $('#nav :input[name="type"]').simplicityFacetedInput({
        dimension: 'type',
        placement: 'append-label',
        numberFormatter: function (count) {
          return $('<option/>').text(count).format({
            format: '#,###',
            locale: 'us'
          }).text();
        }
      });

      $('#conditionCheckboxes :checkbox').simplicityFacetedInput({
        dimension: 'condition',
        placement: 'append-label'
      });

      $('#neighborhoodCheckboxes :checkbox').simplicityFacetedInput({
        dimension: 'locationTree',
        placement: 'append-label'
      });

      $('#neighborhoodCheckboxes2 :checkbox').simplicityInputs({
        dimension: 'location'
      });

      (function () {
        $('#map').simplicityYahooMap()
        .simplicityYahooMapBoundsTracker()
        .simplicityYahooMapResults();

        var map = $('#map').simplicityYahooMap('map');
        map.addPanControl();
        map.addZoomShort();
        map.drawZoomAndCenter(new YGeoPoint(40.75792020879332, -74.00699615478442), 8);
      }());

      $('#map').bind('simplicityyahoomapresultsmarker', function (evt, ui) {
        var marker = ui.marker;
        var properties = ui.row.properties;
        marker.changeImage(new YImage('images/markers/yahoo/' + (ui.row.exact ? 'exact' : 'fuzzy') + '.png'));
        if (properties.type === 'rentals') {
          marker.addAutoExpand('$' + properties.lease);
        } else {
          marker.addAutoExpand('$' + properties.price);
        }
        YEvent.Capture(marker, EventsList.MouseClick, function (evt) {
          $('#result-' + ui.row.id).effect("highlight", {}, 3000);
        });
      });

      var apikey = 'YD-eQRpTl0_JX2E95l_xAFs5UwZUlNQhhn7lj1H';

      $('#locationFields2')
        .simplicityInputs()
        .simplicityYahooGeocoder({
          url: '../test/yahooGeocoderProxy.php',
          requestTemplate: {
            apikey: apikey
          }
        });
      // Position the map based on geocoded address
      var selectCallback = function (evt, ui) {
        if (ui.item && ui.item.bounds) {
          var map = $('#map').simplicityYahooMap('map');
          var bounds = ui.item.bounds;
          var best = map.getBestZoomAndCenter([
            new YGeoPoint(bounds.north, bounds.west),
            new YGeoPoint(bounds.north, bounds.east),
            new YGeoPoint(bounds.south, bounds.east),
            new YGeoPoint(bounds.south, bounds.west)
          ]);
          map.drawZoomAndCenter(best.YGeoPoint, best.zoomLevel);
        }
      };
      // Drive search from current map position
      $('#map').bind('simplicityyahoomapboundstrackerbounds', function (evt, ui) {
        $('#north').val(ui.bounds.north);
        $('#east').val(ui.bounds.east);
        $('#south').val(ui.bounds.south);
        $('#west').val(ui.bounds.west);
        $('#locationFields2').change();
      });
      // Autocomplete based geocoder
      $('#address2').autocomplete({
        minLength: 0,
        source: $('#locationFields2').simplicityYahooGeocoder('autocompleteSource'),
        select: selectCallback,
        change: selectCallback,
        search: function (evt, ui) {
          if ($(evt.target).val() === '') {
            selectCallback(evt, ui);
            return false;
          }
          return true;
        },
        selectFirst: true
      });

      $('#paginationWidget').simplicityPagination();

      $('#searchButton').button().click(function (evt) {
        $('body').simplicityDiscoverySearch('search');
        evt.stopPropagation();
      });
      $('#resetButton').button().click(function (evt) {
        $('body').simplicityState('reset');
        evt.stopPropagation();
      });

      $('#debug').simplicityDebug();

      // Rendered search results
      $('#searchResults').simplicitySearchResults();

      $('body')
        .simplicityState('mergeQueryParams')
        .simplicityState('triggerChangeEvent')
        .simplicityPageSnapBack()
        .simplicityDiscoverySearch({
          url: 'search_controller.php'
        })
        .simplicityDiscoverySearch('search');
    //]]>--></script>
  </body>
</html>
